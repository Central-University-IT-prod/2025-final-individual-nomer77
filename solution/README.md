# Adspresso. PROD 2025

### Инструкция по запуску

Для запуска рекламного движка на машине нужно иметь docker и docker-compose.
После чего в папке solution/ вводим данную команду и проект сам собирается
<code>docker-compose up -d</code>

### Схема данных СУБД

<img src="media/ads_core_adenginesettings.png">

Таблички auth_* и django_* являются техническими и на данной стадии проекта не используются.

### Демонстрация работы приложения + Описание работы основных точек входа

#### Базовые endpoint-ы

<img src="media/example-advertiser-bulk.png">
<img src="media/example-client-bulk.png">

и т.д.

#### Возможность добавления картинки в campaign

Теперь есть возможность при передаче поля 'image' в campaign, прикреплять различные media к рекламным кампаниям.
После прикрепления они остаются доступными на сервере по ссылке из ответа.

![img.png](media/campaign-image-postman.png)
![img.png](media/campaign-image-in-browser.png)

А также прикрепленная картинка, конечно, будет возвращаться при retrieve запросе campaign.

![img.png](media/campaign-image-retrieve.png)

#### Возможность генерации текста для рекламных кампаний

Доступен endpoint POST /advertisers/<advertiser_id>/generate-ad-text

При передаче в data поля 'ad_title', LLM-модель (мы очень технологичный сервис) сгенерирует описание для вашей рекламной кампании,
основываясь на название вашей организации и названии кампании.

![img.png](media/generate-text.png)

#### Возможность модерации текста

Новые доступные endpoint-ы:  
    1. POST moderation/status/on   
    2. POST moderation/status/off  
    3. POST moderation/words

1. Это ручка на включение режима модерации. В данном режиме если в тексте рекламодателя появятся странные слова, мы не пропустим к людям такую рекламу.
2. Это ручка на выключение режима модерации :D
3. В body такого запроса нужно передать "words": ["ban_word1", "ban_word...], такие слова пройдут через алгоритм нормализации (Для корректной фильтрации мы будем использовать начальные формы слов) после чего больше не пройдут к пользователям!

![img.png](media/moderation-status-on.png)
![img.png](media/moderation-status-off.png)
![img.png](media/moderation-words.png)
![img.png](media/moderation-campaign-reject.png)


### Обоснованность решения

В данном решение я использовал следующие технологии:

- PostgreSQL - работаю с ней на всех рабочих проектах, никаких нареканий, так что почему нет?) :D
- pgbouncer - при стандартном соединение с postgres, запросы выполнялись за 600-800мс, pgbouncer помог снизить это время и грамотнее распоряжаться активном пулом соединений
- MiniO - удобное S3-хранилище. Используется для хранения картинок. Выбор пал на неё, т.к. есть очень удобная библиотека django_minio_backend, которая подключает и настраивает minio в считанные минуты
- Redis - используется для кэширования даты + изначально были мысли использовать как брокер сообщений redis stream. Будет очень полезен для дальнейшего введения проекта
